$("#footer").hide();
$("#maincontent").hide();
$(".nav").show();
$(window).scrollTop(0);
$("#maincontent").fadeIn(2000);
$("#maincontent").html( "<%= escape_javascript( render( :partial => "index" ) ) %>" );
$("#footer").fadeIn(3000);
 $(document).ready(function(){
  $('.slider').bxSlider({

      onSlideAfter: function (currentSlideNumber, totalSlideQty, currentSlideHtmlObject) {
       //
      },  
    onSliderLoad: function () {
  //
    
    },
    
    
  });
});

$(function() {
        /* Vimeo Player */
        var togSrc = ["assets/icon-pause-desktop@3x.png", "assets/icon-play-desktop@3x.png"],
        togSrcSound = ["assets/DBC_SOUNDOFF.svg", "assets/DBC_SOUNDON.svg"],
            video,
            volume_level = 0;
            video_state = 'paused',
            $pauseplay = $("#playpause"),
            $setvolume = $("#setvolume"),

            initVideo = function() {
                video_state = 'playing';
                $pauseplay[0].src = togSrc[0];
                $setvolume[0].src = togSrcSound[0];
               
                if (!video.data('init')) {
                    video.data('init', true);
                    video.on("finish", function(){
                            video.vimeo("unload");
                            // video_state = 'paused';

                            console.log("Finished " + video_state);
                            $('.bottom-right').click();
                        })
                        .vimeo("play")
                        //.vimeo("setVolume", 0);
                }

                video.vimeo("play");
            };
        
        if ($('.video').length) {
            $('.slider').bxSlider({

                onSliderLoad: function(currentIndex){
                    xxvideo = slideElement.find('.viewcase');
                    alert(currentIndex);
                    xxxy = xxvideo.attr("href");
                    alert(xxxy);
                    $("#viewcase").attr("href", xxxy)
                },
                onSlideBefore: function (slideElement, oldIndex, newIndex) {
                    console.log('slide before', slideElement, oldIndex, newIndex);
                    
                    video.vimeo("pause");
                    video_state = 'paused';

                    video = slideElement.find('.video');
                   // projecttitle =   slideElement.find('.centered');
                    initVideo();
                    //$('.top-center').prepend($setvolume);
                },
                onSlideAfter: function (slideElement, oldIndex, newIndex) {
                    console.log('slide after', slideElement, oldIndex, newIndex);
                    xxvideo = slideElement.find('.viewcase');
                    xxxy = xxvideo.attr("href");
                   $("#viewcase").attr("href", xxxy);

                }
            });

            video = $('.slider').find('.video:first');
            initVideo();
            //$("#sound-control-center").prepend$('.centered');
            $('.video-wrapper').append($pauseplay);

            // Play / Pause toggle
            $pauseplay.on('click', function(){
                console.log(video_state);
                
                if (video_state == 'paused') {
                    this.src =  togSrc[0];
                    video.vimeo("play");
                    video_state = 'playing';
                } else {
                    this.src =  togSrc[1];
                    video.vimeo("pause");
                    video_state = 'paused';
                }
            });
              

             $setvolume.on('click', function(){

              if (volume_level == 1) {
                this.src =  togSrcSound[0];
                video.vimeo("setVolume", 0);
                volume_level = 0;
                console.log( "Volume is", volume_level ); 
              } else {
                this.src =  togSrcSound[1]; 
                video.vimeo("setVolume", 1);
                console.log( "Volume is", volume_level ); 
                volume_level = 1; 
              }
             //
           });     
        }
    });
